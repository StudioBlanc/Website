<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Selected Works – Studio Blanc</title>
  <!-- Import the shared stylesheet so colours and typography match the homepage -->
  <link rel="stylesheet" href="../style.css">
  <style>
    /* override the homepage header so it doesn’t fill the entire viewport */
    header {
      flex: none;
      text-align: center;
      padding: 60px 20px;
    }
    /* container for the grid and any extra space */
    main {
      width: 100%;
      padding: 0 16px 80px;
      max-width: 1400px;
      margin: 0 auto;
    }
    /* grid layout for portfolio tiles */
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
      gap: 16px;
    }
    .tile {
      position: relative;
      overflow: hidden;
      /* no visible card: remove border radius and shadow */
      border-radius: 0;
      box-shadow: none;
      cursor: pointer;
      /* remove default button borders/outlines so no black frame appears */
      border: none;
      outline: none;
      /* transparent background so only the media shows */
      background: transparent;
      /* centre media within the tile */
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .tile img,
    .tile video {
      /* do not stretch the media; show it fully inside the tile */
      max-width: 100%;
      max-height: 100%;
      width: auto;
      height: auto;
      object-fit: contain;
      display: block;
      /* transparent background so media stands on the tile colour */
      background: transparent;
    }
    .play-icon {
      position: absolute;
      right: 12px;
      bottom: 12px;
      background: rgba(0, 0, 0, 0.6);
      color: #fff;
      padding: 6px 8px;
      border-radius: 50%;
      font-size: 14px;
    }
    .lightbox {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.9);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 200;
    }
    .lightbox.open {
      display: flex;
    }
    /* the lightbox inner container automatically sizes based on its content
       and constrains the media to the viewport dimensions. Using max-width
       and max-height instead of fixed pixel values ensures that very large
       images or videos will scale down and remain centred in the view. */
    .lb-inner {
      position: relative;
      max-width: 96vw;
      max-height: 96vh;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .lb-media {
      max-width: 90vw;
      max-height: 90vh;
      width: auto;
      height: auto;
      border-radius: 12px;
      background: #000;
    }
    .lb-close,
    .lb-prev,
    .lb-next {
      position: absolute;
      top: 12px;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.25);
      color: #fff;
      padding: 10px 12px;
      border-radius: 10px;
      font-size: 14px;
      cursor: pointer;
      backdrop-filter: blur(4px);
    }
    .lb-close { right: 12px; }
    .lb-prev,
    .lb-next { top: 50%; transform: translateY(-50%); }
    .lb-prev { left: 12px; }
    .lb-next { right: 12px; }
    .lb-caption {
      position: absolute;
      left: 16px;
      right: 16px;
      bottom: 12px;
      color: #ddd;
      font-size: 13px;
      text-align: center;
      opacity: 0.9;
    }
  </style>
</head>
<body>
  <header>
    <h1>Selected works</h1>
    <p>A curated selection of our latest CGI &amp; VFX projects.</p>
  </header>
  <main>
    <div id="grid" class="grid"></div>
  </main>
  <!-- lightbox overlay (no nav buttons on the page) -->
  <div id="lightbox" class="lightbox">
    <div class="lb-inner">
      <button class="lb-close" onclick="closeLB()">×</button>
      <button class="lb-prev" onclick="prev()">◀</button>
      <div class="lb-media" id="lb-media"></div>
      <button class="lb-next" onclick="next()">▶</button>
      <div class="lb-caption" id="lb-caption"></div>
    </div>
  </div>
  <script>
    // path to your media folder relative to this page
    const DIR = '../Portfolio';
    const MAX = 200, STOP = 10;
    // probe function to check if an image or video exists
    const probe = (u, v) => new Promise(resolve => {
      const el = v ? document.createElement('video') : new Image();
      if (v) {
        el.preload = 'metadata';
        const s = document.createElement('source');
        s.src = u;
        s.type = 'video/mp4';
        el.appendChild(s);
      }
      el.onload = el.onloadedmetadata = () => resolve(1);
      el.onerror = () => resolve(0);
      el.src = u + '?v=' + Date.now();
    });
    async function scan() {
      const list = [], add = (t, s, n) => list.push({ t, s, n });
      let miss = 0;
      for (let i = 1; i <= MAX; i++) {
        if (await probe(`${DIR}/image${i}.jpg`)) {
          add('img', `${DIR}/image${i}.jpg`, `image${i}`);
          miss = 0;
        } else if (++miss >= STOP) break;
      }
      miss = 0;
      for (let i = 1; i <= MAX; i++) {
        if (await probe(`${DIR}/video${i}.mp4`, 1)) {
          add('vid', `${DIR}/video${i}.mp4`, `video${i}`);
          miss = 0;
        } else if (++miss >= STOP) break;
      }
      return list;
    }
    let ITEMS = [], CUR = -1;
    const grid = document.getElementById('grid');
    const LB = document.getElementById('lightbox');
    const lbMedia = document.getElementById('lb-media');
    const cap = document.getElementById('lb-caption');
    function buildGrid(items) {
      grid.innerHTML = '';
      items.forEach((o, i) => {
        const b = document.createElement('button');
        b.className = 'tile';
        b.onclick = () => open(i);
        if (o.t === 'img') {
          const im = document.createElement('img');
          im.src = o.s;
          im.alt = o.n;
          b.appendChild(im);
        } else {
          const v = document.createElement('video');
          v.muted = true;
          v.playsInline = true;
          const s = document.createElement('source');
          s.src = o.s;
          s.type = 'video/mp4';
          v.appendChild(s);
          b.appendChild(v);
          const badge = document.createElement('span');
          badge.className = 'play-icon';
          badge.textContent = '▶';
          b.appendChild(badge);
        }
        grid.appendChild(b);
      });
    }
    function open(i) {
      CUR = i;
      render();
      LB.classList.add('open');
      // Do not disable page scrolling when the lightbox opens. Allow the
      // underlying page to remain scrollable. This prevents the browser
      // from locking the scroll when the lightbox is active.
    }
    function render() {
      const o = ITEMS[CUR];
      lbMedia.innerHTML = '';
      if (o.t === 'img') {
        const im = document.createElement('img');
        im.src = o.s;
        im.alt = o.n;
        im.style.maxWidth = '100%';
        im.style.maxHeight = '100%';
        lbMedia.appendChild(im);
      } else {
        const v = document.createElement('video');
        // Always show playback controls for videos in the lightbox.
        v.controls = true;
        // Autoplay the video when it is displayed. The muted property is
        // required by most browsers to allow autoplay without user
        // interaction. You can remove muted if you prefer sound on load.
        v.autoplay = true;
        v.muted = true;
        v.playsInline = true;
        const s = document.createElement('source');
        s.src = o.s;
        s.type = 'video/mp4';
        v.appendChild(s);
        lbMedia.appendChild(v);
        // Start playback programmatically to ensure autoplay kicks in on some browsers.
        // Catch and ignore any promise rejection.
        v.play().catch(() => {});
      }
      cap.textContent = o.n;
    }
    function closeLB() {
      LB.classList.remove('open');
      // No need to reset body overflow here since we didn't change it in open().
    }
    function prev() {
      CUR = (CUR - 1 + ITEMS.length) % ITEMS.length;
      render();
    }
    function next() {
      CUR = (CUR + 1) % ITEMS.length;
      render();
    }
    document.addEventListener('keydown', e => {
      if (!LB.classList.contains('open')) return;
      if (e.key === 'ArrowLeft') prev();
      if (e.key === 'ArrowRight') next();
      if (e.key === 'Escape') closeLB();
    });
    scan().then(items => {
      ITEMS = items;
      buildGrid(ITEMS);
    });
  </script>
</body>
</html>
